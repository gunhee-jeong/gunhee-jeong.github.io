---
layout: single
title: "웹펙(Webpack)"
# categories: Git
categories:
  - feDevEnvironment # HTML CSS JavaScript Server Algorithm Wecodes Programmers CS Github Blog
tag: [웹펙, webpack] #tag는 여러개 가능함
toc: true #table of content 기능!
toc_sticky: true
author_profile: true #blog 글안에서는 author_profile이 따라다니지 않도록 설정함
date: 2022-08-02T15:30:00+09:00
# sidebar:
# nav: "docs" #네비게이션에 있는 docs를 의미함
---
<style>
.crimson {
  color: crimson;
  font-weight: bold;
}

.mediumblue {
  color: mediumblue;
  font-weight: bold;
}

.forestgreen {
  color: forestgreen;
  font-weight: bold;
}
</style>

# 웹펙
(Deeming) : [웹펙은 처음이라](https://mnxmnz.github.io/webpack/what-is-webpack/)  
(DaleSeo) : [웹팩 기본 설정법(Entry/ Output/ Loader/ Plugins)](https://www.daleseo.com/webpack-config/)  

웹팩은 소스 디렉터리 안의 <u>index.js 파일</u>과 그 안에 임포트 되어 있는 것들을 하나의 파일 번들로 묶은 후 <span class="crimson">main.js 파일</span>로 떨궈 주게 된다. 이 과정을 흔히 `번들링`이라고 하게 된다.

이제 index.html 파일이 <u>우리가 작성한 원래 소스 파일이 아닌</u> <span class="mediumblue">웹팩이 만들어준 번들 파일을 참조하도록 수정</span>해야한다. 그리고 이때 index.html의 <span class="mediumblue">main.js</span> 경로는 <span class="mediumblue">절대 경로</span>로 지정해야한다.

```html
<!-- index.html -->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Demo</title>
  </head>
  <body>
    <div id="app"></div>
    <script src="/main.js"></script> <!-- '/' 절대경로로 지정! -->
  </body>
</html>
```

그리고 이것은 크롬 뿐만 아니라 익스플로러도 IE8 이상이라면 정상적으로 작동하게 된다. 왜냐하면 웹펙이 바벨을 이용하여 ES6 문법으로 작성된 코드도 ES5 문법으로 변환해주기 때문에 main.js 파일은 ES6 문법을 지원하지 않는 브라우저도 해석할 수 있다.

# 🔴 Entry
`웹펙`은 기본적으로 여러 개의 <span class="forestgreen">자바스크립트 모듈을 하나의 파일로 묶어내는 번들러</span>이다. 따라서 웹펙은 다른 모듈을 사용하고 있는 <span class="mediumblue">최상위 자바스크립트 파일이 어디에 있는지 알아야</span> 하며, 설정 파일에서 이를 <span class="crimson">Entry 속성</span>으로 명시하게 된다. 웹펙은 이 Entry 속성에 명시된 파일을 기준으로 의존성 트리를 만들어 하나의 번들 파일을 만들어 내게 된다. Entry 설정의 <span class="crimson">기본값은 ./src/index.js</span> 이다.

이와 같이 webpack.config.js의 entry를 가지고 기본값을 ./script.js로 변경할 수 있다.

```js
// webpack.confing.js
module.exports = {
  entry: "./script.js",
};
```

```js
const message = document.createTextNode("Webpack Example");
document.body.appendChild(message);
```

위와 같이 설정을 마치고, 터미널에서 npx webpack 커맨드를 실행하면 웹팩이 script.js 파일을 읽어들여 <span class="crimson">main.js 파일</span>로 묶어낸다.

# 🔴 historyApiFallback
## 🟠 History?
(Basemenks) : [Web History란 무엇인가](https://basemenks.tistory.com/269)
(MDN) : [History](https://developer.mozilla.org/ko/docs/Web/API/History)

<span class="crimson">History</span> 인터페이스는 <u>브라우저의 세션 기록</u>, 즉 현재 페이지를 불러온 탭 또는 프레임의 방문 기록을 조작할 수 있는 방법을 제공한다. 즉 세션 기록(페이지 방문 기록)에 대한 접근 방법과 메서드를 제공하는 것이다.

> 세션(session)이란?  
<span class="mediumblue">세션(session)</span>이란 웹 사이트의 여러 페이지에 걸쳐 사용되는 사용자 정보를 저장하는 방법을 의미한다. 사용자가 브라우저를 닫아 서버와의 연결을 끝내는 시점까지를 세션이라 한다. <span class="mediumblue">쿠키</span>는 <u>클라이언트 측의 컴퓨터에 모든 데이터를 저장</u>한다. 하지만 <span class="forestgreen">세션은 서비스가 돌아가는 서버 측에 데이터를 저장</span>하고, 세션의 키값만을 클라이언트 측에 남겨둔다. 브라우저는 필요할 때마다 이 키값을 이용하여 서버에 저장된 데이터를 사용하게 됩니다. 이러한 <u>세션은 보안에 취약한 쿠키를 보완해주는 역할</u>을 한다.

## 🟠 historyApiFallback: true
React Router에서 설정하지 않은 URL에 접속시 NotFoundPage로 이동하도록 미리 설정해주었다. router가 있는 App 컴포넌트의 코드는 아래와 같다.

```jsx
// App.jsx
import {
  Routes,
  Route,
  Link,
} from 'react-router-dom';

import HomePage from './HomePage';
import AboutPage from './AboutPage';
import NotFoundPage from './NotFoundPage';
import RestaurantsPage from './RestaurantsPage';
import RestaurantPage from './RestaurantPage';

export default function App() {
  return (
    <div>
      <header>
        <h1>
          <Link to="/">헤더 영역</Link>
        </h1>
      </header>
      <Routes>
        <Route path="/" element={<HomePage />} />
        <Route path="/about" element={<AboutPage />} />
        <Route path="/restaurants" element={<RestaurantsPage />} />
        <Route path="/restaurants/:id" element={<RestaurantPage />} />
        <Route path="*" element={<NotFoundPage />} />
      </Routes>
    </div>
  );
}
```

그런데 아래의 이미지와 같이 <u>설정되어 있지 않은 URL</u>을 입력하자 <span class="forestgreen">NotFoundPage로 가지 못하고 에러</span>가 발생했다. <u>기존의 MPA</u>의 방식에서는 URL이 바뀌면, <span class="mediumblue">브라우저는 서버에게 URL의 절대 경로에 있는 HTML 파일을 달라고 GET 요청</span>을 보낸다. 마찬가지로 아래의 "/restaurant"은 <span class="crimson">서버에 존재하지 않는 restaurant에 GET 요청</span>을 보냄으로 인하여 404 에러가 발생하게 된 것이다.  
<img src="https://user-images.githubusercontent.com/87808288/190910924-ebcbcb79-e5ae-4d42-8da6-aa30d2e25088.png" width="90%">

<span class="forestgreen">브라우저가 서버에 요청을 보내지 못하도록</span> <u>webpack의 설정을 추가</u>하여 이를 해결할 수 있었다.

```jsx
// webpack.config.js
const path = require('path');

module.exports = {
  entry: path.resolve(__dirname, 'src/index.jsx'),
  module: {
    rules: [
      {
        test: /\.jsx?$/,
        exclude: /node_modules/,
        use: 'babel-loader',
      },
    ],
  },
  resolve: {
    extensions: ['.js', '.jsx'],
  },

  devServer: { // 이 부분을 추가
    historyApiFallback: {
      index: 'index.html',
    },
  },

  // devServer: {
  //   historyApiFallback: true,
  // },
};
```

<u>webpack의 devServer를 설정</u>하게 되면, <span class="forestgreen">URL의 해당 경로에 파일이 존재하지 않을때</span> <span class="mediumblue">index.html로 fallBack</span>하게 된다. 그렇게 404 error가 발생하지 않고 index.html에 script 되어있는 <span class="crimson">main.js</span>를 통해 라우터의 경로가 지정되어 있는 <span class="forestgreen">App 컴포넌트</span>에 내용에 따라 <u>"/restaurant"는 NotFoundPage 컴포넌트가 화면에 출력</u>되게 된다.

기본적으로 webpack은 webpack.config.js에서 설정을 따로 하지 않을 경우 <u>main.js라는 이름으로 public 디렉터리에 저장</u>된다. 그리고 <span class="mediumblue">index.js 파일과 그 안에 import 되어있는 것들</span>을 <span class="crimson">하나의 파일 번들로 묶은 후 main.js 파일로 구성</span>하게된다.

<!-- ⓵ ⓶ ⓷ ⓸ ⓹ ⓺ ⓻ ⓼ ⓽ ⓾ -->

<!-- ### 2. Link 넣기

```

유형 1: (설명어를 입력) : [gunhee's coding blog](https://gunhee-jeong.github.io/)
유형 2: (URL 자동연결) : <https://gunhee-jeong.github.io/>
유형 3: (동일 파일 내 '문단으로 이동') : [1. Header로 이동](###-1-header)

```

유형 1: (설명어를 입력) : [gunhee's coding blog](https://gunhee-jeong.github.io/)
유형 2: (URL 자동연결) : <https://gunhee-jeong.github.io/>
유형 3: (동일 파일 내 '문단으로 이동') : [1. Header로 이동](#1-header)
유형 3의 방법

1. 특수문자를 제거
2. 스페이스는 -로 바꾸고
3. 대문자는 소문자로!
   그래서 ### 1. Header -> #1-header

## Link: [google][https://www.google.com/]

### 3. 수평선

```

---

```

---

### 4. 라인 바꾸기

```

스페이스바를 2번 눌러주면 다음칸으로
이동할 수 있어요!

```

---

스페이스바를 2번 눌러주면
다음칸으로 이동할 수 있어요!

### 5. list 만들기

```

1. 1번
2. 2번
3. 3번

- 순서없는 list
  - 순서없는 list
    - 순서없는 list

```

1. 1번
2. 2번
3. 3번

- 순서없는 list
  - 순서없는 list
    - 순서없는 list

---

### 6. font 관련

```

**진하게** -> 볼드
_기울여서_ -> 이탤릭체
~~취소선~~ -> 취소선

<ul>밑줄넣기</ul> -> 밑줄
<span style="color:red">빨간 글씨</span> -> 글자색
이것이 `인라인` 입니다 -> 인라인 코드
```

**진하게** -> 볼드
_기울여서_ -> 이탤릭체
~~취소선~~ -> 취소선
<u>밑줄넣기</u> -> 밑줄
<span style="color:red">빨간 글씨</span>
이것이 `인라인` 입니다 -> 인라인 코드

---

### 7. 인용구문

```
> coding
>
> > JavaScript
> >
> > > 내가 프짱!
```

> coding
>
> > JavaScript
> >
> > > 내가 프짱!

---

### 8. 이미지 삽입

```
유형1: ('사이즈를 조절' -> HTML 태그 사용) : <img src="https://gunhee-jeong.github.io/assets/images/blogLogo.png" width="300" height="200">
유형2: (이미지 삽입 후 -> 링크 걸기)
[![이미지](https://gunhee-jeong.github.io/assets/images/blogLogo/blogLogo.png)](https://gunhee-jeong.github.io/)
```

유형1: ('사이즈를 조절' -> HTML 태그 사용) : <img src="https://gunhee-jeong.github.io/assets/images/blogLogo.png" width="300" height="200">
유형2: (이미지 삽입 후 -> 링크 걸기)
[![이미지](https://gunhee-jeong.github.io/assets/images/blogLogo.png)](https://gunhee-jeong.github.io/)

### 9. 표 만들기

```
||국어|영어|
| :--- | ---: | :--: |
|건희 | 100점 | 100점
|철수 | 100점 | 100점
```

|      |  국어 | 영어  |
| :--- | ----: | :---: |
| 건희 | 100점 | 100점 |
| 철수 | 100점 | 100점 |

> - header를 넣고 싶은 경우 ---을 사용하고 :을 이용하여 정렬에 사용함!

### 10. 토글 만들기

```
<details>
<summary>여기를 누르세요</summary>
<div markdown="1">
숨겨진 내용
</div>
</details>
```

<details>
<summary>여기를 누르세요</summary>
<div markdown="1">
숨겨진 내용
</div>
</details> -->
