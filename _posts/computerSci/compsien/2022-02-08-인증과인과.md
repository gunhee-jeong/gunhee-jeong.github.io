---
layout: single
title: "인증과 인가"
# categories: Git
categories:
  - CS # HTML CSS JavaScript Server Algorithm Wecodes Programmers CS Github Blog
tag: [인증, 인가] #tag는 여러개 가능함
toc: true #table of content 기능!
toc_sticky: true
author_profile: true #blog 글안에서는 author_profile이 따라다니지 않도록 설정함
# sidebar:
# nav: "docs" #네비게이션에 있는 docs를 의미함
---

# 인증(Authentication)

## 인증이 필요한 이유?

우리 서비스를 누가 쓰며 어떻게 사용하고 있는지 추적이 가능하도록 하기 위해 필요하다.

쿠팡과 같은 사이트들의 본인인증이 없다면 어떻게 되는 것일까?  
우리 사이트를 <u>누가 사용하는지 분석하고 파악할 수 있는 역할</u>을 한다.  
인증을 했다면 어떻게 사이트를 고객이 사용하고 있는지도 알 수 있다.

## 인증에 필요한 것은?

- ID, Email, Password

## 비밀번호는 어떻게 관리해야 하는가?

시스템이 인터넷에서 격리된 네트워크에 위치하는 경우나, 예외적인 개인정보 항목을  
다루는 경우를 제외하고는 <u>국가에서 권고하는 상용 암호화 알고리즘을 이용해</u>  
`개인정보를 암호화하도록 법적으로 요구`하고 있다.

<u>Database에 저장시</u> 개인 <span style="color:red">정보를 해싱하여 복원할 수 없도록</span> 한다.

통신 시 개인 정보를 주고받을 때 SSL을 적용하여 암호화한다. -> <span style="color:red">HTTPS</span>

## 암호화는 어떻게 할까?

### 단방향 해쉬란?

본래 해쉬 함수는 자료구조에서 빠른 자료의 검색, 데이터의 위변조 체크를 위해 사용하지만,  
복원이 불가능한 단방향 해쉬함수는 암호학적 용도로 사용한다.

MD5, SHA-1 -> 둘은 보안취약, SHA-256 등이 있다.  
이와 같은 허점을 이용해서 가능한 경우의 수를 모두 해시값으로 만들어서 판매하는 서비스도  
존재한다.  
Rainbow Table이라고 부르는 것인데, 해시값을 유추해주는 사이트도 존재한다.

이같은 허점을 보완하고자 salting과 key strentchibng이라는 아이디어가 생겨난다.  
Salting & Key Stretching  
&nbsp; 단순해쉬값이 해킹에 쉽게 노출되기 때문에 Salting이라는 아이디어가 생겨났다.  
&nbsp; 입력한 비밀번호와 임의로 생성한 문자열(salt)를 합쳐서 해싱해서 이 해시값을
&nbsp; 저장하는 방법이다.  
&nbsp; 물론 이때에 비교를 위해 해시값과 소금 값을 같이 저장해야 한다.  
&nbsp; 여기에 해커가 패스워드 무작위 대입을 통해 해시값을 계산하는데 필요한 시간을  
&nbsp; 대폭 늘리기 위해 salting 및 해싱을 여러번 반복해서 원본 값을 유추하기  
&nbsp; 어렵기 만드는 것이 `키 스트랫칭`이다.

### bcrypt

Salting & Key Stretching 대표적 라이브러리  
&nbsp; bcrypt는 앞서 말한 개념들을 실제로 적용하기 편하게 해주는 대표적인 라이브러리  
&nbsp; 다양한 언어를 지원하고 있으며, 사용이 간판하여 쉽게 적용이 가능하다.  
&nbsp; bcrypt는 hash 결과값에 소금값과 해시값 및 반복횟수를 같이 보관하기 때문에  
&nbsp; 비밀번호 해싱을 적용하는데 있어 DB 설계를 복잡하게 할 필요가 없다.

# 인가(Authorization)

해당 유저가 request에 해당하는 권한이 있는지 확인하는 절차를 말한다.

HTTP의 특징은?  
&nbsp; 바로 request/ response 요청과 응답  
&nbsp; <span style="color:red">stateless한 성질</span>(저장하지 않는 성질)

## 인가는 무엇일까?

서버는 사용자가 로그인 했을 경우, 로그인을 했다는 것을 어떻게 알수 있을까?  
&nbsp; 바로 headers에 metadata를 보내서 확인하다.  
&nbsp; 이 metadata를 바로 <u>JSON Web Token</u> -> 일명 `'JWT'`이라고 한다.

### JSON Web Token

header에는 토큰의 타입과 해시알고리즘 정보가 들어간다.  
header의 내용은 BASE64 방식으로 인코딩해서 JWT의 가장 첫 부분에 위치한다.

내용(payload)

서명(signature)
&nbsp; JWT가 원본 그대로라는 것을 확인할 때 사용하는 부분이다.  
&nbsp; 시그니쳐는 BASE64URL 인코드된 header와 payload 그리고 JWT secret(별도 생성)을  
&nbsp; 헤더에 지정된 암호 알고리즘으로 암호화하여 전송한다. (복호화 가능)  
&nbsp; 프론트엔드가 JWT를 백엔드 API 서버로 전송하면 서버에서는 전송받은 JWT의  
&nbsp; 서명 부분을 복호화하여 서버에 생성한 JWT가 맞는지 확인한다.  
&nbsp; 마치 계약서의 위변조를 막기위해 서로 사인하는 것과 비슷하다.

<!-- ### 2. Link 넣기

```

유형 1: (설명어를 입력) : [gunhee's coding blog](https://gunhee-jeong.github.io/)
유형 2: (URL 자동연결) : <https://gunhee-jeong.github.io/>
유형 3: (동일 파일 내 '문단으로 이동') : [1. Header로 이동](###-1-header)

```

유형 1: (설명어를 입력) : [gunhee's coding blog](https://gunhee-jeong.github.io/)
유형 2: (URL 자동연결) : <https://gunhee-jeong.github.io/>
유형 3: (동일 파일 내 '문단으로 이동') : [1. Header로 이동](#1-header)
유형 3의 방법

1. 특수문자를 제거
2. 스페이스는 -로 바꾸고
3. 대문자는 소문자로!
   그래서 ### 1. Header -> #1-header

## Link: [google][https://www.google.com/]

### 3. 수평선

```

---

```

---

### 4. 라인 바꾸기

```

스페이스바를 2번 눌러주면 다음칸으로
이동할 수 있어요!

```

---

스페이스바를 2번 눌러주면
다음칸으로 이동할 수 있어요!

### 5. list 만들기

```

1. 1번
2. 2번
3. 3번

- 순서없는 list
  - 순서없는 list
    - 순서없는 list

```

1. 1번
2. 2번
3. 3번

- 순서없는 list
  - 순서없는 list
    - 순서없는 list

---

### 6. font 관련

```

**진하게** -> 볼드
_기울여서_ -> 이탤릭체
~~취소선~~ -> 취소선

<ul>밑줄넣기</ul> -> 밑줄
<span style="color:red">빨간 글씨</span> -> 글자색
이것이 `인라인` 입니다 -> 인라인 코드
```

**진하게** -> 볼드
_기울여서_ -> 이탤릭체
~~취소선~~ -> 취소선
<u>밑줄넣기</u> -> 밑줄
<span style="color:red">빨간 글씨</span>
이것이 `인라인` 입니다 -> 인라인 코드

---

### 7. 인용구문

```
> coding
>
> > JavaScript
> >
> > > 내가 프짱!
```

> coding
>
> > JavaScript
> >
> > > 내가 프짱!

---

### 8. 이미지 삽입

```
유형1: ('사이즈를 조절' -> HTML 태그 사용) : <img src="https://gunhee-jeong.github.io/assets/images/blogLogo.png" width="300" height="200">
유형2: (이미지 삽입 후 -> 링크 걸기)
[![이미지](https://gunhee-jeong.github.io/assets/images/blogLogo/blogLogo.png)](https://gunhee-jeong.github.io/)
```

유형1: ('사이즈를 조절' -> HTML 태그 사용) : <img src="https://gunhee-jeong.github.io/assets/images/blogLogo.png" width="300" height="200">
유형2: (이미지 삽입 후 -> 링크 걸기)
[![이미지](https://gunhee-jeong.github.io/assets/images/blogLogo.png)](https://gunhee-jeong.github.io/)

### 9. 표 만들기

```
||국어|영어|
| :--- | ---: | :--: |
|건희 | 100점 | 100점
|철수 | 100점 | 100점
```

|      |  국어 | 영어  |
| :--- | ----: | :---: |
| 건희 | 100점 | 100점 |
| 철수 | 100점 | 100점 |

> - header를 넣고 싶은 경우 ---을 사용하고 :을 이용하여 정렬에 사용함!

### 10. 토글 만들기

```
<details>
<summary>여기를 누르세요</summary>
<div markdown="1">
숨겨진 내용
</div>
</details>
```

<details>
<summary>여기를 누르세요</summary>
<div markdown="1">
숨겨진 내용
</div>
</details> -->
